<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chessboard Square Classification</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body { font-family: 'Noto Sans', sans-serif; }
    .title { color: #363636; }
    .publication-title { font-family: 'Google Sans', sans-serif; font-weight: bold; font-size: 2.5rem; }
    .publication-authors { font-size: 1.3rem; margin-top: 20px; }
    .abstract-text { font-size: 1.1rem; line-height: 1.6; }
    .hero-body { padding: 3rem 1.5rem; }
    .image-caption { font-size: 0.9rem; color: #666; font-style: italic; margin-top: 10px; text-align: center; }
    .box { box-shadow: 0 0.5em 1em -0.125em rgba(10, 10, 10, 0.1), 0 0px 0 1px rgba(10, 10, 10, 0.02); }

    /* Alignment system */
    .text-block{
      max-width: 860px;
      margin: 0 auto;
      text-align: left;
    }
    .text-block .content { text-align: left; }
    .text-block p { margin-bottom: 0.9rem; }
    .text-block ol, .text-block ul { margin-left: 1.2rem; }

    /* Center list used in OOD section */
    .center-list{
      list-style-position: inside;
      margin: 0 auto;
      padding-left: 0;
      display: inline-block;
      text-align: left;
    }
    .center-list li{ margin-bottom: 0.45rem; }

    /* OOD figure layout */
    .ood-grid{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      max-width: 980px;
      margin: 0 auto;
    }
    .ood-card{
      border: 1px solid rgba(10,10,10,0.08);
      border-radius: 12px;
      overflow: hidden;
      background: #fff;
    }
    .ood-card img{
      display:block;
      width:100%;
      height:auto;
    }
    .ood-card .ood-cap{
      padding: 10px 12px;
      color: #666;
      font-size: 0.92rem;
      border-top: 1px solid rgba(10,10,10,0.08);
      text-align: center;
    }

    .hero-line{
      font-family: 'Noto Sans', sans-serif;
      font-size: 1.1rem;
      font-weight: 400;
      line-height: 1.6;
      color: #363636;
    }

    @media (max-width: 768px){
      .ood-grid{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop has-text-centered">
        <h1 class="title publication-title">Chessboard Square Classification &<br>Board Reconstruction</h1>

        <div class="is-size-5 publication-authors">
          <span class="author-block">Yuval Kutai</span>,
          <span class="author-block">Rotem Harduf</span>,
          <span class="author-block">Koral Shilon</span>
        </div>

        <div class="is-size-5 publication-authors">
          <span class="author-block">B.Sc. Final Project, Computer Science Department</span>
        </div>

        <div class="column has-text-centered">
          <div class="publication-links">
            <span class="link-block">
              <a href="https://github.com/yuvalku/Chessboard-Square-Classification" class="external-link button is-normal is-rounded is-dark">
                <span class="icon"><i class="fab fa-github"></i></span>
                <span>Code</span>
              </a>
            </span>
            <span class="link-block">
              <a href="./Chess-Board Squares Classification.pdf" class="external-link button is-normal is-rounded is-dark">
                <span class="icon"><i class="fas fa-file-pdf"></i></span>
                <span>Presentation</span>
              </a>
            </span>
          </div>
        </div>

      </div>
    </div>
  </section>

  <section class="hero is-light is-small">
    <div class="hero-body">
      <div class="container is-max-desktop has-text-centered">
        <img src="assets/static/board5.jpg" style="max-height: 400px; border-radius: 10px;" alt="Input chessboard">
        <h2 class="hero-line" style="margin-top: 15px;">
          Translating real-world chessboard images into digital FEN notation using Deep Learning.
        </h2>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered">Abstract</h2>

      <div class="text-block">
        <div class="content abstract-text">
          <p>
            Digitalizing a physical chess game is a complex computer vision challenge.
            While synthetic datasets are easy to solve, real-world images introduce <strong>shadows, occlusions, and perspective distortions</strong>.
          </p>
          <p>
            This project presents an end-to-end pipeline that detects the board, slices it into squares,
            and classifies each piece using a fine-tuned <strong>ResNet18</strong> model.
            We bridge the "Sim2Real" gap using robust data augmentation and geometric heuristics,
            achieving <strong>95.5% accuracy</strong> on real-world test data.
          </p>
        </div>
      </div>

    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered">Method & Pipeline</h2>

      <div class="text-block">
        <div class="content">
          <p>Our approach processes the raw image in three main stages:</p>
          <ol>
            <li><strong>Preprocessing:</strong> Detecting board corners and applying Perspective Transform to flatten the board.</li>
            <li><strong>Slicing:</strong> Dividing the aligned board into 64 individual square images.</li>
            <li><strong>Classification:</strong> Each square is fed into a CNN (ResNet18) to predict one of 13 classes (Pieces or Empty).</li>
          </ol>
        </div>
      </div>

      <div class="has-text-centered" style="margin-top: 18px;">
        <img src="assets/static/pipeline.png" style="width: 90%; max-width: 980px;" alt="Pipeline">
        <p class="image-caption">Figure 1: The full processing pipeline from raw input to FEN string.</p>
      </div>
    </div>
  </section>

  <!-- FIXED: OOD section (images + caption are inside the section, no broken closing tags) -->
  <section class="section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered">Out-of-Distribution (OOD) Handling</h2>

      <div class="text-block">
        <div class="content">
          <p>
            In our project, OOD handling is implemented during inference in <strong>predict.py</strong>.
            Each square is checked before we trust the classifier output. If a square looks invalid or the model is not confident enough,
            we mark it as <strong>OOD</strong> (an internal OOD class id) to avoid confident but wrong piece predictions.
          </p>

          <ul class="center-list">
            <li><strong>Visual validity checks:</strong> The square crop is rejected if it fails basic quality or structure tests (for example heavy blur or not enough visual structure).</li>
            <li><strong>Uncertainty thresholds:</strong> A square is flagged as OOD when the prediction confidence is too low (softmax confidence) or when uncertainty is too high (entropy).</li>
            <li><strong>Clear visualization:</strong> OOD squares are marked explicitly in the rendered board (red X) so it is easy to see where the pipeline is uncertain.</li>
            <li><strong>FEN behavior:</strong> In the printed FEN, OOD squares are treated like empty squares, so many OOD flags mean the FEN is less reliable.</li>
            <li><strong>Tunable thresholds:</strong> Thresholds are being used (<code>CONF_THRESHOLD</code> and <code>ENTROPY_THRESHOLD</code>) to trade off between coverage and reliability.</li>
          </ul>

          <p class="muted" style="margin-bottom: 10px;">
            Examples below show challenging inputs where OOD flags prevent forcing incorrect labels.
          </p>
        </div>
      </div>

      <div class="ood-grid">
        <div class="ood-card">
          <img src="assets/static/board1.jpeg" alt="OOD example 1">
          <div class="ood-cap">
            <strong>Example 1:</strong> Occlusion and uneven illumination. Some squares are partially visible, so low-confidence squares are flagged instead of forcing labels.
          </div>
        </div>

        <div class="ood-card">
          <img src="assets/static/board2.jpeg" alt="OOD example 2">
          <div class="ood-cap">
            <strong>Example 2:</strong> Strong perspective or blur. The pipeline relies on preprocessing retries and board-level checks to avoid inconsistent reconstructions.
          </div>
        </div>
      </div>

      <p class="image-caption" style="margin-top: 10px;">
        Figure 2: OOD examples used to demonstrate robustness strategies.
      </p>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <h2 class="title is-3 has-text-centered">Results</h2>

      <div class="text-block">
        <div class="content">
          <p>
            We achieved a test accuracy of <strong>95.5%</strong>. The confusion matrix below demonstrates near-perfect separation between empty and occupied squares.
          </p>
        </div>
      </div>

      <div class="has-text-centered" style="margin-top: 18px;">
        <img src="assets/for_report/evaluation_confusion_matrix.png" style="width: 80%; max-width: 980px; margin-bottom: 20px;" alt="Confusion matrix">
      </div>

      <div class="text-block">
        <div class="box">
          <h4 class="title is-4">Key Insights</h4>
          <div class="content">
            <ul>
              <li><strong>Preprocessing is Key:</strong> Model accuracy is strictly bound by the board cropping quality. A minor grid drift leads to immediate misclassification.</li>
              <li><strong>Geometric Ambiguity:</strong> The main source of error is the visual similarity between the <strong>White Bishop</strong> and <strong>White Pawn</strong> in top-down views.</li>
              <li><strong>Detail Loss:</strong> Resizing crops to 224x224 can erase fine features like the King's cross.</li>
            </ul>
          </div>
        </div>
      </div>

    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
        <p>
          Project page for <strong>Chessboard Square Classification</strong>.
          <br>
          <a href="https://github.com/yuvalku/Chessboard-Square-Classification" class="icon-link">
            <i class="fab fa-github"></i> View on GitHub
          </a>
        </p>
      </div>
    </div>
  </footer>

</body>
</html>